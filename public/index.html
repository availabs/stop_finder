<script src="http://cdn.leafletjs.com/leaflet-0.7.1/leaflet.js"></script>
<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.1/leaflet.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
<link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
<script src="https://d3js.org/d3.v4.min.js" /></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"/></script>
<script src="./javascripts/paramHelpers.js" /></script> <!-- Helps with window/url search params -->
<script src="./javascripts/prettyDataKeys.js" /></script> <!-- Helps with formatting ugly data keys from DB -->
<script src="./javascripts/getDataHelpers.js" /></script> <!-- Helps with getting data (realtime or static bus stops) -->
<script src="./javascripts/displayHelpers.js" /></script> <!-- Helps with displaying data or display changes -->
<link rel="stylesheet" href="/stylesheets/style.css">
<div class='container-fluid' id="page_container">
  <div class="row no-gutters" id="header_container">
    <div class="col-6">
      <div class="card text-center">
        <div class="card-block">
          <h1 class="card-title">Bus</h1>
        </div>
      </div>
    </div>
    <div class="col-6">
      <div class="card text-center">
        <div class="card-block">
          <h1 class="card-title">Train</h1>
        </div>
      </div>
    </div>
  </div>
  <div id="stops"></div>
</div>
<script>  
  var params = getSearchParameters();

  if(navigator && navigator.geolocation){
    navigator.geolocation.getCurrentPosition(position => {

      /*
      * Just a "random"  lat-lng in NJ
      */
      var start = [ 
        params.lat || 40.487692978918865,
        params.lng || -74.38568115234375
      ]

      /*
      * Actually uses geolocation
      */
      // var start = [ 
      //   position.coords.latitude,
      //   position.coords.longitude
      // ]

      /*
      *
      * LEAFLET TAKES COORDS AS: LAT/LNG
      * POSTGIS TAKES COORDS AS: LNG/LAT
      * Parameter is LAT/LNG in order to work with Leaflet
      * Function reverses it when creating URL to get data
      *
      */
      getStopData(start)

    })
  }
  else{
    console.log("No location was provided")
  }
</script>